---
layout: post
title:  "身份证最后一位校验算法(ISO 7064:1983.MOD 11-2)"
date:   2019-12-18 11:35:20
tags: 算法 身份证校验
description: ''
color: 'rgb(154,133,255)'
cover: '../assets/blogImg/201912181143.jpg'
---

![](../assets/blogImg/201912181143.jpg)

在生活中，有一些游戏账号的实名认证和申请
或者某些网站的注册会用到身份证号。


当输入错误的身份证号时会提示出错
给人的感觉是他们真的能识别身份证信息一样。
当然，除了一些政府、银行、证券、保险等行业接入的是NCIIC（全国公民身份证号码查询服务中心）
其他的大多数都是根据最后一位校验位来判断该身份证号码是否有效。

<!--more-->
目前国内最权威的渠道肯定是全国公民身份证号码查询服务中心，简称NCIIC，
也就是很多实名认证服务商所声称采用的公安部接口。
实际上由于公安网跟外网是隔绝的，所以公安部的接口绝对是不会直接对外的提供的。
NCIIC是隶属于公安部的一个事业单位，可以直连国家人口基础信息库，
其数据权威性主要表现在：数据更新准确，公民的出生、死亡、 姓名变更等信息都会第一时间更新，
可以满足政府、金融等机构的对数据质量的高要求。
所以NCIIC的授权范围，也主要集中在政府、银行、证券、保险等行业。

#### 结构和形式

1．号码的结构
　　公民身份号码是特征组合码，由十七位数字本体码和一位校验码组成。排列顺序从左至右依次为：六位数字地址码，八位数字出生日期码，三位数字顺序码和一位数字校验码。
2．地址码
　　表示编码对象常住户口所在县（县级市、旗、区）的行政区划代码，按GB/T2260的规定执行。
3．出生日期码
　　表示编码对象出生的年、月、日，按GB/T7408的规定执行，年、月、日代码之间不用分隔符。
4．顺序码
　　表示在同一地址码所标识的区域范围内，对同年、同月、同日出生的人编定的顺序号，顺序码的奇数分配给男性，偶数分配给女性。
5．校验码
　　根据前面十七位数字码，按照ISO 7064:1983.MOD 11-2校验码计算出来的检验码。

地址码：
华北地区：北京市|110000，天津市|120000，河北省|130000，山西省|140000，内蒙古自治区|150000
东北地区： 辽宁省|210000，吉林省|220000，黑龙江省|230000
华东地区： 上海市|310000，江苏省|320000，浙江省|330000，安徽省|340000，福建省|350000，江西省|360000，山东省|370000
华中地区： 河南省|410000，湖北省|420000，湖南省|430000
华南地区：广东省|440000，广西壮族自治区|450000，海南省|460000
西南地区：重庆市|500000，四川省|510000，贵州省|520000，云南省|530000，西藏自治区|540000
西北地区： 陕西省|610000，甘肃省|620000，青海省|630000，宁夏回族自治区|640000，新疆维吾尔自治区|650000
特别地区：台湾地区(886)|830000，香港特别行政区（852)|810000，澳门特别行政区（853)|820000


中国大陆居民身份证号码中的地址码的数字编码规则为：
第一、二位表示省（自治区、直辖市、特别行政区）。
第一位数字是以前的大区制代码。第二位是大区所在省市编码。全国共分为6个大区：华北局（1）、东北局（2）、华东局（3）、中南局（4）、西南局（5）和西北局（6）
第三、四位表示市（地级市、自治州、盟及国家直辖市所属市辖区和县的汇总码）。其中，01-20，51-70表示省直辖市；21-50表示地区（自治州、盟）。
第五、六位表示县（市辖区、县级市、旗）。01-18表示市辖区或地区（自治州、盟）辖县级市；21-80表示县（旗）；81-99表示省直辖县级市。


其中第十七位奇数分给男性，偶数分给女性。
作为尾号的校验码，是由号码编制单位按统一的公式计算出来的，如果某人的尾号是0-9，都不会出现X，但如果尾号是10，那么就得用X来代替


#### ISO 7064:1983.MOD 11-2计算方法

1、将前面的身份证号码17位数分别乘以不同的系数。从第一位到第十七位的系数分别为：7－9－10－5－8－4－2－1－6－3－7－9－10－5－8－4－2。
2、将这17位数字和系数相乘的结果相加。
3、用加出来和除以11，看余数是多少？
4、余数只可能有0－1－2－3－4－5－6－7－8－9－10这11个数字。其分别对应的最后一位身份证的号码为1－0－X －9－8－7－6－5－4－3－2。(即余数0对应1，余数1对应0，余数2对应X...)
5、通过上面得知如果余数是3，就会在身份证的第18位数字上出现的是9。如果对应的数字是2，身份证的最后一位号码就是罗马数字X。
例如：某男性的身份证号码为【53010219200508011X】， 我们看看这个身份证是不是符合计算规则的身份证。
首先我们得出前17位的乘积和【`(5*7)+(3*9)+(0*10)+(1*5)+(0*8)+(2*4)+(1*2)+(9*1)+(2*6)+(0*3)+(0*7)+(5*9)+(0*10)+(8*5)+(0*8)+(1*4)+(1*2)`】是189，然后用189除以11得出的结果是189÷11=17余下2，187÷11=17，还剩下2不能被除尽，也就是说其余数是2。最后通过对应规则就可以知道余数2对应的检验码是X。所以，可以判定这是一个正确的身份证号码。



JavaScript代码如下：

```
//验证方法
function verifyCode(id){
 if(id.length !=18 )
  return false;
 /*1、从第一位到第十七位的系数分别为：
   7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2
   将这17位数字和系数相乘的结果相加。 */
 var arr = [7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2];
 var sum = 0;
 for(var i=0; i<arr.length; i++){
  sum += parseInt(id.charAt(i)) * arr[i];
 }
 //2、用加出来和除以11，看余数，
 var c = sum%11;
 //3、分别对应的最后一位身份证的号码为：1－0－X－9－8－7－6－5－4－3－2
 var ch = [‘1‘, ‘0‘, ‘X‘, ‘9‘, ‘8‘, ‘7‘, ‘6‘, ‘5‘, ‘4‘, ‘3‘, ‘2‘];
 var code = ch[c];
 var last = id.charAt(17);
 last = last==‘x‘ ? ‘X‘: last;
 return last == code;
 }
``` 

```
var id = "34052419800101001X";
 console.log(verifyCode(id));
```